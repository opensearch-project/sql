{
  "calcite": {
    "logical": "LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])\n  LogicalProject(avg_age=[$1], age_range=[$0])\n    LogicalAggregate(group=[{0}], avg_age=[AVG($1)])\n      LogicalProject(age_range=[CASE(<($10, 30), 'u30':VARCHAR, SEARCH($10, Sarg[[30..40]]), 'u40':VARCHAR, 'u100':VARCHAR)], age=[$10])\n        CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_bank]])\n",
    "physical": "CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_bank]], PushDownContext=[[AGGREGATION->rel#:LogicalAggregate.NONE.[](input=RelSubset#,group={0},avg_age=AVG($1)), PROJECT->[avg_age, age_range], LIMIT->10000], OpenSearchRequestBuilder(sourceBuilder={\"from\":0,\"size\":0,\"timeout\":\"1m\",\"aggregations\":{\"composite_buckets\":{\"composite\":{\"size\":1000,\"sources\":[{\"age_range\":{\"terms\":{\"script\":{\"source\":\"{\\\"langType\\\":\\\"calcite\\\",\\\"script\\\":\\\"{\\\\n  \\\\\\\"op\\\\\\\": {\\\\n    \\\\\\\"name\\\\\\\": \\\\\\\"CASE\\\\\\\",\\\\n    \\\\\\\"kind\\\\\\\": \\\\\\\"CASE\\\\\\\",\\\\n    \\\\\\\"syntax\\\\\\\": \\\\\\\"SPECIAL\\\\\\\"\\\\n  },\\\\n  \\\\\\\"operands\\\\\\\": [\\\\n    {\\\\n      \\\\\\\"op\\\\\\\": {\\\\n        \\\\\\\"name\\\\\\\": \\\\\\\"<\\\\\\\",\\\\n        \\\\\\\"kind\\\\\\\": \\\\\\\"LESS_THAN\\\\\\\",\\\\n        \\\\\\\"syntax\\\\\\\": \\\\\\\"BINARY\\\\\\\"\\\\n      },\\\\n      \\\\\\\"operands\\\\\\\": [\\\\n        {\\\\n          \\\\\\\"dynamicParam\\\\\\\": 0,\\\\n          \\\\\\\"type\\\\\\\": {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"INTEGER\\\\\\\",\\\\n            \\\\\\\"nullable\\\\\\\": true\\\\n          }\\\\n        },\\\\n        {\\\\n          \\\\\\\"dynamicParam\\\\\\\": 1,\\\\n          \\\\\\\"type\\\\\\\": {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"INTEGER\\\\\\\",\\\\n            \\\\\\\"nullable\\\\\\\": false\\\\n          }\\\\n        }\\\\n      ]\\\\n    },\\\\n    {\\\\n      \\\\\\\"dynamicParam\\\\\\\": 2,\\\\n      \\\\\\\"type\\\\\\\": {\\\\n        \\\\\\\"type\\\\\\\": \\\\\\\"VARCHAR\\\\\\\",\\\\n        \\\\\\\"nullable\\\\\\\": false,\\\\n        \\\\\\\"precision\\\\\\\": -1\\\\n      }\\\\n    },\\\\n    {\\\\n      \\\\\\\"op\\\\\\\": {\\\\n        \\\\\\\"name\\\\\\\": \\\\\\\"SEARCH\\\\\\\",\\\\n        \\\\\\\"kind\\\\\\\": \\\\\\\"SEARCH\\\\\\\",\\\\n        \\\\\\\"syntax\\\\\\\": \\\\\\\"INTERNAL\\\\\\\"\\\\n      },\\\\n      \\\\\\\"operands\\\\\\\": [\\\\n        {\\\\n          \\\\\\\"dynamicParam\\\\\\\": 3,\\\\n          \\\\\\\"type\\\\\\\": {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"INTEGER\\\\\\\",\\\\n            \\\\\\\"nullable\\\\\\\": true\\\\n          }\\\\n        },\\\\n        {\\\\n          \\\\\\\"literal\\\\\\\": {\\\\n            \\\\\\\"rangeSet\\\\\\\": [\\\\n              [\\\\n                \\\\\\\"closed\\\\\\\",\\\\n                \\\\\\\"30\\\\\\\",\\\\n                \\\\\\\"40\\\\\\\"\\\\n              ]\\\\n            ],\\\\n            \\\\\\\"nullAs\\\\\\\": \\\\\\\"UNKNOWN\\\\\\\"\\\\n          },\\\\n          \\\\\\\"type\\\\\\\": {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"INTEGER\\\\\\\",\\\\n            \\\\\\\"nullable\\\\\\\": false\\\\n          }\\\\n        }\\\\n      ]\\\\n    },\\\\n    {\\\\n      \\\\\\\"dynamicParam\\\\\\\": 4,\\\\n      \\\\\\\"type\\\\\\\": {\\\\n        \\\\\\\"type\\\\\\\": \\\\\\\"VARCHAR\\\\\\\",\\\\n        \\\\\\\"nullable\\\\\\\": false,\\\\n        \\\\\\\"precision\\\\\\\": -1\\\\n      }\\\\n    },\\\\n    {\\\\n      \\\\\\\"dynamicParam\\\\\\\": 5,\\\\n      \\\\\\\"type\\\\\\\": {\\\\n        \\\\\\\"type\\\\\\\": \\\\\\\"VARCHAR\\\\\\\",\\\\n        \\\\\\\"nullable\\\\\\\": false,\\\\n        \\\\\\\"precision\\\\\\\": -1\\\\n      }\\\\n    }\\\\n  ]\\\\n}\\\"}\",\"lang\":\"opensearch_compounded_script\",\"params\":{\"utcTimestamp\":1765422175375883000,\"SOURCES\":[0,2,2,0,2,2],\"DIGESTS\":[\"age\",30,\"u30\",\"age\",\"u40\",\"u100\"]}},\"missing_bucket\":true,\"missing_order\":\"first\",\"order\":\"asc\"}}}]},\"aggregations\":{\"avg_age\":{\"avg\":{\"field\":\"age\"}}}}}}, requestedTotalSize=2147483647, pageSize=null, startFrom=0)])\n",
    "extended": "public org.apache.calcite.linq4j.Enumerable bind(final org.apache.calcite.DataContext root) {\n  final org.opensearch.sql.opensearch.storage.scan.CalciteEnumerableIndexScan v1stashed = (org.opensearch.sql.opensearch.storage.scan.CalciteEnumerableIndexScan) root.get(\"v1stashed\");\n  return v1stashed.scan();\n}\n\n\npublic Class getElementType() {\n  return java.lang.Object[].class;\n}\n\n\n"
  }
}
