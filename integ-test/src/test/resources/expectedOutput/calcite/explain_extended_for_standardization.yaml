calcite:
  logical: |
    LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalProject(avg_age=[$1], age_range=[$0])
        LogicalAggregate(group=[{0}], avg_age=[AVG($1)])
          LogicalProject(age_range=[CASE(<($10, 30), 'u30':VARCHAR, SEARCH($10, Sarg[[30..40]]), 'u40':VARCHAR, 'u100':VARCHAR)], age=[$10])
            CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_bank]])
  physical: |
    CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_bank]], PushDownContext=[[AGGREGATION->rel#:LogicalAggregate.NONE.[](input=RelSubset#,group={0},avg_age=AVG($1)), PROJECT->[avg_age, age_range], LIMIT->10000], OpenSearchRequestBuilder(sourceBuilder={"from":0,"size":0,"timeout":"1m","aggregations":{"composite_buckets":{"composite":{"size":1000,"sources":[{"age_range":{"terms":{"script":{"source":"{\"langType\":\"calcite\",\"script\":\"{\\n  \\\"op\\\": {\\n    \\\"name\\\": \\\"CASE\\\",\\n    \\\"kind\\\": \\\"CASE\\\",\\n    \\\"syntax\\\": \\\"SPECIAL\\\"\\n  },\\n  \\\"operands\\\": [\\n    {\\n      \\\"op\\\": {\\n        \\\"name\\\": \\\"<\\\",\\n        \\\"kind\\\": \\\"LESS_THAN\\\",\\n        \\\"syntax\\\": \\\"BINARY\\\"\\n      },\\n      \\\"operands\\\": [\\n        {\\n          \\\"dynamicParam\\\": 0,\\n          \\\"type\\\": {\\n            \\\"type\\\": \\\"BIGINT\\\",\\n            \\\"nullable\\\": true\\n          }\\n        },\\n        {\\n          \\\"dynamicParam\\\": 1,\\n          \\\"type\\\": {\\n            \\\"type\\\": \\\"BIGINT\\\",\\n            \\\"nullable\\\": true\\n          }\\n        }\\n      ]\\n    },\\n    {\\n      \\\"dynamicParam\\\": 2,\\n      \\\"type\\\": {\\n        \\\"type\\\": \\\"VARCHAR\\\",\\n        \\\"nullable\\\": true,\\n        \\\"precision\\\": -1\\n      }\\n    },\\n    {\\n      \\\"op\\\": {\\n        \\\"name\\\": \\\"AND\\\",\\n        \\\"kind\\\": \\\"AND\\\",\\n        \\\"syntax\\\": \\\"BINARY\\\"\\n      },\\n      \\\"operands\\\": [\\n        {\\n          \\\"op\\\": {\\n            \\\"name\\\": \\\"<=\\\",\\n            \\\"kind\\\": \\\"LESS_THAN_OR_EQUAL\\\",\\n            \\\"syntax\\\": \\\"BINARY\\\"\\n          },\\n          \\\"operands\\\": [\\n            {\\n              \\\"dynamicParam\\\": 3,\\n              \\\"type\\\": {\\n                \\\"type\\\": \\\"BIGINT\\\",\\n                \\\"nullable\\\": true\\n              }\\n            },\\n            {\\n              \\\"dynamicParam\\\": 4,\\n              \\\"type\\\": {\\n                \\\"type\\\": \\\"BIGINT\\\",\\n                \\\"nullable\\\": true\\n              }\\n            }\\n          ]\\n        },\\n        {\\n          \\\"op\\\": {\\n            \\\"name\\\": \\\"<=\\\",\\n            \\\"kind\\\": \\\"LESS_THAN_OR_EQUAL\\\",\\n            \\\"syntax\\\": \\\"BINARY\\\"\\n          },\\n          \\\"operands\\\": [\\n            {\\n              \\\"dynamicParam\\\": 5,\\n              \\\"type\\\": {\\n                \\\"type\\\": \\\"BIGINT\\\",\\n                \\\"nullable\\\": true\\n              }\\n            },\\n            {\\n              \\\"dynamicParam\\\": 6,\\n              \\\"type\\\": {\\n                \\\"type\\\": \\\"BIGINT\\\",\\n                \\\"nullable\\\": true\\n              }\\n            }\\n          ]\\n        }\\n      ]\\n    },\\n    {\\n      \\\"dynamicParam\\\": 7,\\n      \\\"type\\\": {\\n        \\\"type\\\": \\\"VARCHAR\\\",\\n        \\\"nullable\\\": true,\\n        \\\"precision\\\": -1\\n      }\\n    },\\n    {\\n      \\\"dynamicParam\\\": 8,\\n      \\\"type\\\": {\\n        \\\"type\\\": \\\"VARCHAR\\\",\\n        \\\"nullable\\\": true,\\n        \\\"precision\\\": -1\\n      }\\n    }\\n  ]\\n}\"}","lang":"opensearch_compounded_script","params":{"utcTimestamp": 0,"SOURCES":[0,2,2,2,0,0,2,2,2],"DIGESTS":["age",30,"u30",30,"age","age",40,"u40","u100"]}},"missing_bucket":true,"missing_order":"first","order":"asc"}}}]},"aggregations":{"avg_age":{"avg":{"field":"age"}}}}}}, requestedTotalSize=10000, pageSize=null, startFrom=0)])
