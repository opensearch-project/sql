calcite:
  logical: |
    LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalProject(status=[$0], _MAP=[$1])
        LogicalFilter(condition=[=($0, '200')])
          LogicalProject(status=[CAST(ITEM(JSON_EXTRACT_ALL($3), 'status')):VARCHAR], _MAP=[map_append(MAP_FROM_ARRAYS(ARRAY('@timestamp':VARCHAR, 'created_at':VARCHAR, 'level':VARCHAR, 'message':VARCHAR, 'server':VARCHAR), ARRAY(CAST($2):VARCHAR, CAST($0):VARCHAR, $4, $3, $1)), map_remove(JSON_EXTRACT_ALL($3), ARRAY('status':VARCHAR)))])
            CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_logs]])
  physical: |
    EnumerableLimit(fetch=[10000])
      EnumerableCalc(expr#0..10=[{inputs}], expr#11=[JSON_EXTRACT_ALL($t3)], expr#12=['status'], expr#13=[ITEM($t11, $t12)], expr#14=[CAST($t13):VARCHAR], expr#15=['@timestamp':VARCHAR], expr#16=['created_at':VARCHAR], expr#17=['level':VARCHAR], expr#18=['message':VARCHAR], expr#19=['server':VARCHAR], expr#20=[ARRAY($t15, $t16, $t17, $t18, $t19)], expr#21=[CAST($t2):VARCHAR], expr#22=[CAST($t0):VARCHAR], expr#23=[ARRAY($t21, $t22, $t4, $t3, $t1)], expr#24=[MAP_FROM_ARRAYS($t20, $t23)], expr#25=['status':VARCHAR], expr#26=[ARRAY($t25)], expr#27=[map_remove($t11, $t26)], expr#28=[map_append($t24, $t27)], expr#29=['200':VARCHAR], expr#30=[=($t14, $t29)], status=[$t14], _MAP=[$t28], $condition=[$t30])
        CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_logs]])
