calcite:
  logical: |
    LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalProject(patterns_field=[SAFE_CAST(ITEM(PATTERN_PARSER(SAFE_CAST(ITEM($1, 'pattern')), ITEM($1, 'sample_logs'), true), 'pattern'))], pattern_count=[SAFE_CAST(ITEM($1, 'pattern_count'))], tokens=[SAFE_CAST(ITEM(PATTERN_PARSER(SAFE_CAST(ITEM($1, 'pattern')), ITEM($1, 'sample_logs'), true), 'tokens'))], sample_logs=[SAFE_CAST(ITEM($1, 'sample_logs'))])
        LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{0}])
          LogicalAggregate(group=[{}], patterns_field=[pattern($0, $1, $2, $3)])
            LogicalProject(email=[$9], $f17=[10], $f18=[100000], $f19=[true])
              CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]])
          Uncollect
            LogicalProject(patterns_field=[$cor0.patterns_field])
              LogicalValues(tuples=[[{ 0 }]])
  physical: |
    EnumerableLimit(fetch=[10000])
      EnumerableCalc(expr#0..1=[{inputs}], expr#2=['pattern'], expr#3=[ITEM($t1, $t2)], expr#4=[SAFE_CAST($t3)], expr#5=['sample_logs'], expr#6=[ITEM($t1, $t5)], expr#7=[true], expr#8=[PATTERN_PARSER($t4, $t6, $t7)], expr#9=[ITEM($t8, $t2)], expr#10=[SAFE_CAST($t9)], expr#11=['pattern_count'], expr#12=[ITEM($t1, $t11)], expr#13=[SAFE_CAST($t12)], expr#14=['tokens'], expr#15=[ITEM($t8, $t14)], expr#16=[SAFE_CAST($t15)], expr#17=[SAFE_CAST($t6)], patterns_field=[$t10], pattern_count=[$t13], tokens=[$t16], sample_logs=[$t17])
        EnumerableCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{0}])
          CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]], PushDownContext=[[AGGREGATION->rel#:LogicalAggregate.NONE.[](input=RelSubset#,group={},patterns_field=pattern($0, $1, $2, $3))], OpenSearchRequestBuilder(sourceBuilder={"from":0,"size":0,"timeout":"1m","aggregations":{"patterns_field":{"scripted_metric":{"init_script":{"source":"{\"langType\":\"calcite\",\"script\":\"rO0ABXQCCnsKICAib3AiOiB7CiAgICAibmFtZSI6ICJQQVRURVJOX0lOSVRfVURGIiwKICAgICJraW5kIjogIk9USEVSX0ZVTkNUSU9OIiwKICAgICJzeW50YXgiOiAiRlVOQ1RJT04iCiAgfSwKICAib3BlcmFuZHMiOiBbCiAgICB7CiAgICAgICJkeW5hbWljUGFyYW0iOiAwLAogICAgICAidHlwZSI6IHsKICAgICAgICAidHlwZSI6ICJBTlkiLAogICAgICAgICJudWxsYWJsZSI6IGZhbHNlLAogICAgICAgICJwcmVjaXNpb24iOiAtMSwKICAgICAgICAic2NhbGUiOiAtMjE0NzQ4MzY0OAogICAgICB9CiAgICB9CiAgXSwKICAiY2xhc3MiOiAib3JnLm9wZW5zZWFyY2guc3FsLmV4cHJlc3Npb24uZnVuY3Rpb24uVXNlckRlZmluZWRGdW5jdGlvbkJ1aWxkZXIkMSIsCiAgInR5cGUiOiB7CiAgICAidHlwZSI6ICJBTlkiLAogICAgIm51bGxhYmxlIjogZmFsc2UsCiAgICAicHJlY2lzaW9uIjogLTEsCiAgICAic2NhbGUiOiAtMjE0NzQ4MzY0OAogIH0sCiAgImRldGVybWluaXN0aWMiOiB0cnVlLAogICJkeW5hbWljIjogZmFsc2UKfQ==\"}","lang":"opensearch_compounded_script","params":{"utcTimestamp": 0,"SOURCES":[3],"DIGESTS":["state"]}},"map_script":{"source":"{\"langType\":\"calcite\",\"script\":\"rO0ABXQEW3sKICAib3AiOiB7CiAgICAibmFtZSI6ICJQQVRURVJOX0FERF9VREYiLAogICAgImtpbmQiOiAiT1RIRVJfRlVOQ1RJT04iLAogICAgInN5bnRheCI6ICJGVU5DVElPTiIKICB9LAogICJvcGVyYW5kcyI6IFsKICAgIHsKICAgICAgImR5bmFtaWNQYXJhbSI6IDAsCiAgICAgICJ0eXBlIjogewogICAgICAgICJ0eXBlIjogIkFOWSIsCiAgICAgICAgIm51bGxhYmxlIjogZmFsc2UsCiAgICAgICAgInByZWNpc2lvbiI6IC0xLAogICAgICAgICJzY2FsZSI6IC0yMTQ3NDgzNjQ4CiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgICJkeW5hbWljUGFyYW0iOiAxLAogICAgICAidHlwZSI6IHsKICAgICAgICAidHlwZSI6ICJWQVJDSEFSIiwKICAgICAgICAibnVsbGFibGUiOiB0cnVlLAogICAgICAgICJwcmVjaXNpb24iOiAtMQogICAgICB9CiAgICB9LAogICAgewogICAgICAiZHluYW1pY1BhcmFtIjogMiwKICAgICAgInR5cGUiOiB7CiAgICAgICAgInR5cGUiOiAiSU5URUdFUiIsCiAgICAgICAgIm51bGxhYmxlIjogdHJ1ZQogICAgICB9CiAgICB9LAogICAgewogICAgICAiZHluYW1pY1BhcmFtIjogMywKICAgICAgInR5cGUiOiB7CiAgICAgICAgInR5cGUiOiAiSU5URUdFUiIsCiAgICAgICAgIm51bGxhYmxlIjogdHJ1ZQogICAgICB9CiAgICB9LAogICAgewogICAgICAiZHluYW1pY1BhcmFtIjogNCwKICAgICAgInR5cGUiOiB7CiAgICAgICAgInR5cGUiOiAiSU5URUdFUiIsCiAgICAgICAgIm51bGxhYmxlIjogdHJ1ZQogICAgICB9CiAgICB9LAogICAgewogICAgICAiZHluYW1pY1BhcmFtIjogNSwKICAgICAgInR5cGUiOiB7CiAgICAgICAgInR5cGUiOiAiRE9VQkxFIiwKICAgICAgICAibnVsbGFibGUiOiB0cnVlCiAgICAgIH0KICAgIH0KICBdLAogICJjbGFzcyI6ICJvcmcub3BlbnNlYXJjaC5zcWwuZXhwcmVzc2lvbi5mdW5jdGlvbi5Vc2VyRGVmaW5lZEZ1bmN0aW9uQnVpbGRlciQxIiwKICAidHlwZSI6IHsKICAgICJ0eXBlIjogIkFOWSIsCiAgICAibnVsbGFibGUiOiBmYWxzZSwKICAgICJwcmVjaXNpb24iOiAtMSwKICAgICJzY2FsZSI6IC0yMTQ3NDgzNjQ4CiAgfSwKICAiZGV0ZXJtaW5pc3RpYyI6IHRydWUsCiAgImR5bmFtaWMiOiBmYWxzZQp9\"}","lang":"opensearch_compounded_script","params":{"utcTimestamp": 0,"SOURCES":[3,0,2,2,2,2],"DIGESTS":["state","email.keyword",10,100000,5,0.3]}},"combine_script":{"source":"{\"langType\":\"calcite\",\"script\":\"rO0ABXQAgHsKICAiZHluYW1pY1BhcmFtIjogMCwKICAidHlwZSI6IHsKICAgICJ0eXBlIjogIkFOWSIsCiAgICAibnVsbGFibGUiOiBmYWxzZSwKICAgICJwcmVjaXNpb24iOiAtMSwKICAgICJzY2FsZSI6IC0yMTQ3NDgzNjQ4CiAgfQp9\"}","lang":"opensearch_compounded_script","params":{"utcTimestamp": 0,"SOURCES":[3],"DIGESTS":["state"]}},"reduce_script":{"source":"{\"langType\":\"calcite\",\"script\":\"rO0ABXQEH3sKICAib3AiOiB7CiAgICAibmFtZSI6ICJQQVRURVJOX1JFU1VMVF9VREYiLAogICAgImtpbmQiOiAiT1RIRVJfRlVOQ1RJT04iLAogICAgInN5bnRheCI6ICJGVU5DVElPTiIKICB9LAogICJvcGVyYW5kcyI6IFsKICAgIHsKICAgICAgImR5bmFtaWNQYXJhbSI6IDAsCiAgICAgICJ0eXBlIjogewogICAgICAgICJ0eXBlIjogIkFOWSIsCiAgICAgICAgIm51bGxhYmxlIjogZmFsc2UsCiAgICAgICAgInByZWNpc2lvbiI6IC0xLAogICAgICAgICJzY2FsZSI6IC0yMTQ3NDgzNjQ4CiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgICJkeW5hbWljUGFyYW0iOiAxLAogICAgICAidHlwZSI6IHsKICAgICAgICAidHlwZSI6ICJJTlRFR0VSIiwKICAgICAgICAibnVsbGFibGUiOiB0cnVlCiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgICJkeW5hbWljUGFyYW0iOiAyLAogICAgICAidHlwZSI6IHsKICAgICAgICAidHlwZSI6ICJJTlRFR0VSIiwKICAgICAgICAibnVsbGFibGUiOiB0cnVlCiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgICJkeW5hbWljUGFyYW0iOiAzLAogICAgICAidHlwZSI6IHsKICAgICAgICAidHlwZSI6ICJET1VCTEUiLAogICAgICAgICJudWxsYWJsZSI6IHRydWUKICAgICAgfQogICAgfSwKICAgIHsKICAgICAgImR5bmFtaWNQYXJhbSI6IDQsCiAgICAgICJ0eXBlIjogewogICAgICAgICJ0eXBlIjogIkJPT0xFQU4iLAogICAgICAgICJudWxsYWJsZSI6IHRydWUKICAgICAgfQogICAgfQogIF0sCiAgImNsYXNzIjogIm9yZy5vcGVuc2VhcmNoLnNxbC5leHByZXNzaW9uLmZ1bmN0aW9uLlVzZXJEZWZpbmVkRnVuY3Rpb25CdWlsZGVyJDEiLAogICJ0eXBlIjogewogICAgInR5cGUiOiAiQVJSQVkiLAogICAgIm51bGxhYmxlIjogdHJ1ZSwKICAgICJjb21wb25lbnQiOiB7CiAgICAgICJ0eXBlIjogIkFOWSIsCiAgICAgICJudWxsYWJsZSI6IGZhbHNlLAogICAgICAicHJlY2lzaW9uIjogLTEsCiAgICAgICJzY2FsZSI6IC0yMTQ3NDgzNjQ4CiAgICB9CiAgfSwKICAiZGV0ZXJtaW5pc3RpYyI6IHRydWUsCiAgImR5bmFtaWMiOiBmYWxzZQp9\"}","lang":"opensearch_compounded_script","params":{"utcTimestamp": 0,"SOURCES":[3,2,2,2,2],"DIGESTS":["states",10,5,0.3,true]}}}}}}, requestedTotalSize=2147483647, pageSize=null, startFrom=0)])
          EnumerableUncollect
            EnumerableCalc(expr#0=[{inputs}], expr#1=[$cor0], expr#2=[$t1.patterns_field], patterns_field=[$t2])
              EnumerableValues(tuples=[[{ 0 }]])
