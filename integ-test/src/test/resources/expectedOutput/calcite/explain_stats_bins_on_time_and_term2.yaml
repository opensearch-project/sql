calcite:
  logical: |
    LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalProject(avg(cpu_usage)=[ROUND($2, 2)], @timestamp=[$3], region=[$1])
        LogicalAggregate(group=[{0, 1}], avg(cpu_usage)=[AVG($2)], @timestamp=[MIN($3)])
          LogicalProject(@timestamp_bin=[$16], region=[$8], cpu_usage=[$7], @timestamp=[$1])
            LogicalFilter(condition=[AND(IS NOT NULL($1), IS NOT NULL($8))])
              LogicalProject(environment=[$0], @timestamp=[$1], status_code=[$2], service=[$3], host=[$4], memory_usage=[$5], response_time=[$6], cpu_usage=[$7], region=[$8], bytes_sent=[$9], _id=[$10], _index=[$11], _score=[$12], _maxscore=[$13], _sort=[$14], _routing=[$15], @timestamp_bin=[WIDTH_BUCKET($1, 3, MIN($1) OVER (), MAX($1) OVER ())])
                CalciteLogicalIndexScan(table=[[OpenSearch, events]])
  physical: |
    EnumerableLimit(fetch=[10000])
      EnumerableCalc(expr#0..4=[{inputs}], expr#5=[0], expr#6=[=($t3, $t5)], expr#7=[null:DOUBLE], expr#8=[CASE($t6, $t7, $t2)], expr#9=[/($t8, $t3)], expr#10=[2], expr#11=[ROUND($t9, $t10)], avg(cpu_usage)=[$t11], @timestamp=[$t4], region=[$t1])
        EnumerableAggregate(group=[{0, 1}], agg#0=[$SUM0($2)], agg#1=[COUNT($2)], @timestamp=[MIN($3)])
          EnumerableCalc(expr#0..4=[{inputs}], expr#5=[3], expr#6=[WIDTH_BUCKET($t0, $t5, $t3, $t4)], expr#7=[IS NOT NULL($t0)], expr#8=[IS NOT NULL($t2)], expr#9=[AND($t7, $t8)], @timestamp_bin=[$t6], region=[$t2], cpu_usage=[$t1], @timestamp=[$t0], $condition=[$t9])
            EnumerableWindow(window#0=[window(aggs [MIN($0), MAX($0)])])
              CalciteEnumerableIndexScan(table=[[OpenSearch, events]], PushDownContext=[[PROJECT->[@timestamp, cpu_usage, region]], OpenSearchRequestBuilder(sourceBuilder={"from":0,"timeout":"1m","_source":{"includes":["@timestamp","cpu_usage","region"],"excludes":[]}}, requestedTotalSize=2147483647, pageSize=null, startFrom=0)])