calcite:
  logical: |
    LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalProject(status=[$0], _MAP=[$1])
        LogicalFilter(condition=[=($0, '200')])
          LogicalProject(status=[CAST(ITEM(JSON_EXTRACT_ALL($3), 'status')):VARCHAR], _MAP=[map_append(MAP_FROM_ARRAYS(ARRAY('@timestamp':VARCHAR, 'created_at':VARCHAR, 'level':VARCHAR, 'message':VARCHAR, 'server':VARCHAR), ARRAY(CAST($2):VARCHAR, CAST($0):VARCHAR, $4, $3, $1)), map_remove(JSON_EXTRACT_ALL($3), ARRAY('status':VARCHAR)))])
            CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_logs]])
  physical: |
    EnumerableCalc(expr#0..4=[{inputs}], expr#5=[JSON_EXTRACT_ALL($t0)], expr#6=['status'], expr#7=[ITEM($t5, $t6)], expr#8=[CAST($t7):VARCHAR], expr#9=['@timestamp':VARCHAR], expr#10=['created_at':VARCHAR], expr#11=['level':VARCHAR], expr#12=['message':VARCHAR], expr#13=['server':VARCHAR], expr#14=[ARRAY($t9, $t10, $t11, $t12, $t13)], expr#15=[CAST($t1):VARCHAR], expr#16=[CAST($t2):VARCHAR], expr#17=[ARRAY($t15, $t16, $t3, $t0, $t4)], expr#18=[MAP_FROM_ARRAYS($t14, $t17)], expr#19=['status':VARCHAR], expr#20=[ARRAY($t19)], expr#21=[map_remove($t5, $t20)], expr#22=[map_append($t18, $t21)], status=[$t8], _MAP=[$t22])
      CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_logs]], PushDownContext=[[PROJECT->[message, @timestamp, created_at, level, server], SCRIPT->=(CAST(ITEM(JSON_EXTRACT_ALL($0), 'status')):VARCHAR, '200'), LIMIT->10000], OpenSearchRequestBuilder(sourceBuilder={"from":0,"size":10000,"timeout":"1m","query":{"script":{"script":{"source":"{\"langType\":\"calcite\",\"script\":\"rO0ABXQHkHsKICAib3AiOiB7CiAgICAibmFtZSI6ICI9IiwKICAgICJraW5kIjogIkVRVUFMUyIsCiAgICAic3ludGF4IjogIkJJTkFSWSIKICB9LAogICJvcGVyYW5kcyI6IFsKICAgIHsKICAgICAgIm9wIjogewogICAgICAgICJuYW1lIjogIkNBU1QiLAogICAgICAgICJraW5kIjogIkNBU1QiLAogICAgICAgICJzeW50YXgiOiAiU1BFQ0lBTCIKICAgICAgfSwKICAgICAgIm9wZXJhbmRzIjogWwogICAgICAgIHsKICAgICAgICAgICJvcCI6IHsKICAgICAgICAgICAgIm5hbWUiOiAiSVRFTSIsCiAgICAgICAgICAgICJraW5kIjogIklURU0iLAogICAgICAgICAgICAic3ludGF4IjogIlNQRUNJQUwiCiAgICAgICAgICB9LAogICAgICAgICAgIm9wZXJhbmRzIjogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgIm9wIjogewogICAgICAgICAgICAgICAgIm5hbWUiOiAiSlNPTl9FWFRSQUNUX0FMTCIsCiAgICAgICAgICAgICAgICAia2luZCI6ICJPVEhFUl9GVU5DVElPTiIsCiAgICAgICAgICAgICAgICAic3ludGF4IjogIkZVTkNUSU9OIgogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgIm9wZXJhbmRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAiZHluYW1pY1BhcmFtIjogMCwKICAgICAgICAgICAgICAgICAgInR5cGUiOiB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVkFSQ0hBUiIsCiAgICAgICAgICAgICAgICAgICAgIm51bGxhYmxlIjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAicHJlY2lzaW9uIjogLTEKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgImNsYXNzIjogIm9yZy5vcGVuc2VhcmNoLnNxbC5leHByZXNzaW9uLmZ1bmN0aW9uLlVzZXJEZWZpbmVkRnVuY3Rpb25CdWlsZGVyJDEiLAogICAgICAgICAgICAgICJ0eXBlIjogewogICAgICAgICAgICAgICAgInR5cGUiOiAiTUFQIiwKICAgICAgICAgICAgICAgICJudWxsYWJsZSI6IHRydWUsCiAgICAgICAgICAgICAgICAia2V5IjogewogICAgICAgICAgICAgICAgICAidHlwZSI6ICJWQVJDSEFSIiwKICAgICAgICAgICAgICAgICAgIm51bGxhYmxlIjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICJwcmVjaXNpb24iOiAtMQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IHsKICAgICAgICAgICAgICAgICAgInR5cGUiOiAiQU5ZIiwKICAgICAgICAgICAgICAgICAgIm51bGxhYmxlIjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICJwcmVjaXNpb24iOiAtMSwKICAgICAgICAgICAgICAgICAgInNjYWxlIjogLTIxNDc0ODM2NDgKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICJkZXRlcm1pbmlzdGljIjogdHJ1ZSwKICAgICAgICAgICAgICAiZHluYW1pYyI6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAiZHluYW1pY1BhcmFtIjogMSwKICAgICAgICAgICAgICAidHlwZSI6IHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIlZBUkNIQVIiLAogICAgICAgICAgICAgICAgIm51bGxhYmxlIjogdHJ1ZSwKICAgICAgICAgICAgICAgICJwcmVjaXNpb24iOiAtMQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0KICAgICAgXSwKICAgICAgInR5cGUiOiB7CiAgICAgICAgInR5cGUiOiAiVkFSQ0hBUiIsCiAgICAgICAgIm51bGxhYmxlIjogdHJ1ZSwKICAgICAgICAicHJlY2lzaW9uIjogLTEKICAgICAgfQogICAgfSwKICAgIHsKICAgICAgImR5bmFtaWNQYXJhbSI6IDIsCiAgICAgICJ0eXBlIjogewogICAgICAgICJ0eXBlIjogIlZBUkNIQVIiLAogICAgICAgICJudWxsYWJsZSI6IHRydWUsCiAgICAgICAgInByZWNpc2lvbiI6IC0xCiAgICAgIH0KICAgIH0KICBdCn0=\"}","lang":"opensearch_compounded_script","params":{"utcTimestamp": 0,"SOURCES":[0,2,2],"DIGESTS":["message.keyword","status","200"]}},"boost":1.0}},"_source":{"includes":["message","@timestamp","created_at","level","server"],"excludes":[]}}, requestedTotalSize=10000, pageSize=null, startFrom=0)])
