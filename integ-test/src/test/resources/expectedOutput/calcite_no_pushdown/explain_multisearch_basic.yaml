
calcite:
  logical: |
    LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalProject(count=[$1], age_group=[$0])
        LogicalAggregate(group=[{0}], count=[COUNT()])
          LogicalProject(age_group=[$11])
            LogicalUnion(all=[true])
              LogicalProject(account_number=[$0], firstname=[$1], address=[$2], balance=[$3], gender=[$4], city=[$5], employer=[$6], state=[$7], age=[$8], email=[$9], lastname=[$10], age_group=['young'])
                LogicalFilter(condition=[<($8, 30)])
                  CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]])
              LogicalProject(account_number=[$0], firstname=[$1], address=[$2], balance=[$3], gender=[$4], city=[$5], employer=[$6], state=[$7], age=[$8], email=[$9], lastname=[$10], age_group=['adult'])
                LogicalFilter(condition=[>=($8, 30)])
                  CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]])
  physical: |
    EnumerableLimit(fetch=[10000])
      EnumerableCalc(expr#0..1=[{inputs}], count=[$t1], age_group=[$t0])
        EnumerableAggregate(group=[{0}], count=[COUNT()])
          EnumerableUnion(all=[true])
            EnumerableCalc(expr#0..16=[{inputs}], expr#17=['young'], expr#18=[30:BIGINT], expr#19=[<($t8, $t18)], age_group=[$t17], $condition=[$t19])
              CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]])
            EnumerableCalc(expr#0..16=[{inputs}], expr#17=['adult'], expr#18=[30:BIGINT], expr#19=[>=($t8, $t18)], age_group=[$t17], $condition=[$t19])
              CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]])
