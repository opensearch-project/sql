calcite:
  logical: |
    LogicalSystemLimit(fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalAggregate(group=[{0}], row 1=[MAX($1) FILTER $2], row 2=[MAX($1) FILTER $3], row 3=[MAX($1) FILTER $4], row 4=[MAX($1) FILTER $5])
        LogicalProject(column_names=[TRIM(FLAG(BOTH), ' ', $18)], $f1=[$19], $f2=[=($17, 1)], $f3=[=($17, 2)], $f4=[=($17, 3)], $f5=[=($17, 4)])
          LogicalFilter(condition=[IS NOT NULL($19)])
            LogicalProject(account_number=[$0], firstname=[$1], address=[$2], balance=[$3], gender=[$4], city=[$5], employer=[$6], state=[$7], age=[$8], email=[$9], lastname=[$10], _id=[$11], _index=[$12], _score=[$13], _maxscore=[$14], _sort=[$15], _routing=[$16], _row_number_transpose_=[$17], column_names=[$18], value=[CASE(=($18, 'account_number'), CAST($0):VARCHAR, =($18, 'firstname'), $1, =($18, 'address'), $2, =($18, 'balance'), CAST($3):VARCHAR, =($18, 'gender'), $4, =($18, 'city'), $5, =($18, 'employer'), $6, =($18, 'state'), $7, =($18, 'age'), CAST($8):VARCHAR, =($18, 'email'), $9, =($18, 'lastname'), $10, null:VARCHAR)])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalSort(fetch=[5])
                  LogicalProject(account_number=[$0], firstname=[$1], address=[$2], balance=[$3], gender=[$4], city=[$5], employer=[$6], state=[$7], age=[$8], email=[$9], lastname=[$10], _id=[$11], _index=[$12], _score=[$13], _maxscore=[$14], _sort=[$15], _routing=[$16], _row_number_transpose_=[ROW_NUMBER() OVER ()])
                    CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]])
                LogicalValues(tuples=[[{ 'account_number' }, { 'firstname' }, { 'address' }, { 'balance' }, { 'gender' }, { 'city' }, { 'employer' }, { 'state' }, { 'age' }, { 'email' }, { 'lastname' }]])
  physical: |
    EnumerableLimit(fetch=[10000])
      EnumerableAggregate(group=[{0}], row 1=[MAX($1) FILTER $2], row 2=[MAX($1) FILTER $3], row 3=[MAX($1) FILTER $4], row 4=[MAX($1) FILTER $5])
        EnumerableCalc(expr#0..12=[{inputs}], expr#13=[FLAG(BOTH)], expr#14=[' '], expr#15=[TRIM($t13, $t14, $t12)], expr#16=['account_number':VARCHAR], expr#17=[=($t12, $t16)], expr#18=[CAST($t0):VARCHAR], expr#19=['firstname':VARCHAR], expr#20=[=($t12, $t19)], expr#21=['address':VARCHAR], expr#22=[=($t12, $t21)], expr#23=['balance':VARCHAR], expr#24=[=($t12, $t23)], expr#25=[CAST($t3):VARCHAR], expr#26=['gender':VARCHAR], expr#27=[=($t12, $t26)], expr#28=['city':VARCHAR], expr#29=[=($t12, $t28)], expr#30=['employer':VARCHAR], expr#31=[=($t12, $t30)], expr#32=['state':VARCHAR], expr#33=[=($t12, $t32)], expr#34=['age':VARCHAR], expr#35=[=($t12, $t34)], expr#36=[CAST($t8):VARCHAR], expr#37=['email':VARCHAR], expr#38=[=($t12, $t37)], expr#39=['lastname':VARCHAR], expr#40=[=($t12, $t39)], expr#41=[null:VARCHAR], expr#42=[CASE($t17, $t18, $t20, $t1, $t22, $t2, $t24, $t25, $t27, $t4, $t29, $t5, $t31, $t6, $t33, $t7, $t35, $t36, $t38, $t9, $t40, $t10, $t41)], expr#43=[1:BIGINT], expr#44=[=($t11, $t43)], expr#45=[2:BIGINT], expr#46=[=($t11, $t45)], expr#47=[3:BIGINT], expr#48=[=($t11, $t47)], expr#49=[4:BIGINT], expr#50=[=($t11, $t49)], column_names=[$t15], $f1=[$t42], $f2=[$t44], $f3=[$t46], $f4=[$t48], $f5=[$t50])
          EnumerableNestedLoopJoin(condition=[OR(AND(=($12, 'account_number'), IS NOT NULL($0)), AND(=($12, 'firstname'), IS NOT NULL($1)), AND(=($12, 'address'), IS NOT NULL($2)), AND(=($12, 'balance'), IS NOT NULL($3)), AND(=($12, 'gender'), IS NOT NULL($4)), AND(=($12, 'city'), IS NOT NULL($5)), AND(=($12, 'employer'), IS NOT NULL($6)), AND(=($12, 'state'), IS NOT NULL($7)), AND(=($12, 'age'), IS NOT NULL($8)), AND(=($12, 'email'), IS NOT NULL($9)), AND(=($12, 'lastname'), IS NOT NULL($10)))], joinType=[inner])
            EnumerableLimit(fetch=[5])
              EnumerableWindow(window#0=[window(rows between UNBOUNDED PRECEDING and CURRENT ROW aggs [ROW_NUMBER()])])
                CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]], PushDownContext=[[PROJECT->[account_number, firstname, address, balance, gender, city, employer, state, age, email, lastname]], OpenSearchRequestBuilder(sourceBuilder={"from":0,"timeout":"1m","_source":{"includes":["account_number","firstname","address","balance","gender","city","employer","state","age","email","lastname"],"excludes":[]}}, requestedTotalSize=2147483647, pageSize=null, startFrom=0)])
            EnumerableValues(tuples=[[{ 'account_number' }, { 'firstname' }, { 'address' }, { 'balance' }, { 'gender' }, { 'city' }, { 'employer' }, { 'state' }, { 'age' }, { 'email' }, { 'lastname' }]])
