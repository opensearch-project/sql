calcite:
  logical: |
    LogicalSystemLimit(sort0=[$1], sort1=[$3], dir0=[ASC-nulls-first], dir1=[DESC-nulls-last], fetch=[10000], type=[QUERY_SIZE_LIMIT])
      LogicalProject(account_number=[$0], gender=[$1], age=[$2], state=[$3], new_gender=[$4], new_state=[$5])
        LogicalFilter(condition=[<=($6, SAFE_CAST(2:BIGINT))])
          LogicalProject(account_number=[$0], gender=[$1], age=[$2], state=[$3], new_gender=[$4], new_state=[$5], _row_number_dedup_=[ROW_NUMBER() OVER (PARTITION BY $1, $3)])
            LogicalFilter(condition=[AND(IS NOT NULL($1), IS NOT NULL($3))])
              LogicalSort(sort0=[$1], sort1=[$3], dir0=[ASC-nulls-first], dir1=[DESC-nulls-last])
                LogicalProject(account_number=[$0], gender=[$4], age=[$8], state=[$7], new_gender=[LOWER($4)], new_state=[LOWER($7)])
                  CalciteLogicalIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]])
  physical: |
    EnumerableCalc(expr#0..6=[{inputs}], proj#0..5=[{exprs}])
      EnumerableLimit(fetch=[10000])
        EnumerableCalc(expr#0..6=[{inputs}], expr#7=[2:BIGINT], expr#8=[<=($t6, $t7)], proj#0..6=[{exprs}], $condition=[$t8])
          EnumerableWindow(window#0=[window(partition {1, 3} rows between UNBOUNDED PRECEDING and CURRENT ROW aggs [ROW_NUMBER()])])
            EnumerableCalc(expr#0..3=[{inputs}], expr#4=[LOWER($t1)], expr#5=[LOWER($t3)], proj#0..5=[{exprs}])
              CalciteEnumerableIndexScan(table=[[OpenSearch, opensearch-sql_test_index_account]], PushDownContext=[[PROJECT->[account_number, gender, age, state], SORT->[{
      "gender.keyword" : {
        "order" : "asc",
        "missing" : "_first"
      }
    }, {
      "state.keyword" : {
        "order" : "desc",
        "missing" : "_last"
      }
    }], FILTER->AND(IS NOT NULL($1), IS NOT NULL($3))], OpenSearchRequestBuilder(sourceBuilder={"from":0,"timeout":"1m","query":{"bool":{"must":[{"exists":{"field":"gender","boost":1.0}},{"exists":{"field":"state","boost":1.0}}],"adjust_pure_negative":true,"boost":1.0}},"_source":{"includes":["account_number","gender","age","state"],"excludes":[]},"sort":[{"gender.keyword":{"order":"asc","missing":"_first"}},{"state.keyword":{"order":"desc","missing":"_last"}}]}, requestedTotalSize=2147483647, pageSize=null, startFrom=0)])
